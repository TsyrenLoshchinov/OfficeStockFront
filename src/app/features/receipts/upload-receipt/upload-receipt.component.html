<div class="add-receipt">
    <input type="file" id="file-input" accept=".jpg,.jpeg,.png,.pdf" style="display: none;"
        (change)="onFileSelected($event)">

    <!-- Состояние 1: Default (нет файла) -->
    <div *ngIf="!selectedFile && !isUploading" class="receipt-window receipt-default">
        <button class="download-button btn-default" (click)="onButtonClick()">
            <div class="frame-4">
                <div class="frame-5">
                    <span class="btn-text">Загрузить чек</span>
                </div>
            </div>
        </button>
        <div class="format-text">
            Допустимые форматы: JPG, JPEG, PNG, PDF<br>Максимальный размер файла: 10 МБ
        </div>
        <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>
    </div>

    <!-- Состояние 2: Receipt Added (файл загружен) -->
    <div *ngIf="selectedFile && !isUploading" class="receipt-window receipt-added">
        <div class="image-placeholder"></div>
        <button class="download-button btn-added" (click)="onButtonClick()">
            <div class="frame-4">
                <div class="frame-5">
                    <span class="btn-text">Выбрать другой файл</span>
                </div>
            </div>
        </button>
        <div class="frame-6">
            <span class="success-text" *ngIf="!errorMessage">Файл {{ fileInfo?.name }} успешно загружен</span>
            <span class="error-text" *ngIf="errorMessage">{{ errorMessage }}</span>
        </div>
        <div class="action-buttons">
            <button class="text-button" (click)="retryUpload()" *ngIf="errorMessage"><span>Повторить</span></button>
            <button class="text-button" (click)="cancelUpload()"><span>Отмена</span></button>
        </div>
    </div>

    <!-- Состояние 3: Download Process (загрузка в процессе) -->
    <div *ngIf="isUploading" class="receipt-window receipt-process">
        <div class="image-placeholder process-image"></div>

        <!-- Контейнер прогресс-бара (ПОДНЯТ ВЫШЕ КНОПКИ) -->
        <div class="process-frame-6">
            <div class="progress-label">Загрузка чека</div>
            <div class="progress-container">
                <div class="progress-line" [style.width.%]="uploadProgress"></div>
            </div>
            <span class="progress-text">{{ uploadProgress }}%</span>
        </div>

        <!-- Кнопка под прогресс-баром -->
        <button class="download-button btn-process" disabled>
            <div class="frame-4 frame-4-process">
                <div class="frame-5 frame-5-process">
                    <span class="btn-text btn-text-process">Добавить чек</span>
                </div>
            </div>
        </button>

        <button class="text-button process-text-button" (click)="cancelUpload()"><span>Отмена</span></button>
    </div>
</div>